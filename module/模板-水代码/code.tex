\documentclass[12pt, a4paper, oneside]{ctexart}
\usepackage{amsmath, amsthm, amssymb, bm, graphicx, hyperref, mathrsfs, color}
\usepackage{pgfplots, tikz, listings, framed}
\usepackage{geometry}
\geometry{left=2.54cm,right=2.54cm,top=3.18cm,bottom=3.18cm}

\title{\textbf{CODE.}}
\author{Shiyuu}
\date{\today}
\linespread{1.5}
%定义了题目,解答,注记三个环境
\newcounter{problemname}
\newenvironment{problem}{\stepcounter{problemname}\par\noindent\textbf{题目\arabic{problemname}. }}{\\\par}
\newenvironment{solution}{\par\noindent\textbf{解答. }}{\\\par}
\newenvironment{note}{\par\noindent\textbf{题目\arabic{problemname}的注记. }}{\\\par}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

%cpp代码环境设置

\lstset{%
	language=C++,
	backgroundcolor=\color{white},
	basicstyle=\tiny,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=t,
    frame=shadowbox,
    rulesepcolor= \color{red!20!green!20!blue!20},
	commentstyle=\color{mygreen},
	deletekeywords={...},
	escapeinside={\%*}{*)},
	extendedchars=true,
	frame=single,
	keepspaces=true,
	keywordstyle=\color{blue},
	language=Octave,
	%otherkeywords={*,...},
	numbers=left,
	numbersep=5pt,
	numberstyle=\tiny\color{mygray},
	rulecolor=\color{black},
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	stepnumber=1,
	stringstyle=\color{mymauve},
	tabsize=4,
	title=\lstname
}
\lstdefinestyle{customcpp}{
	belowcaptionskip=0pt,
	breaklines=true,
	%frame=L,
	xleftmargin=\parindent,
	language=C++,
	showstringspaces=false,
	basicstyle=\scriptsize\ttfamily,
	keywordstyle=\bfseries\color{green!40!black},
	commentstyle=\itshape\color{purple!40!black},
	identifierstyle=\color{blue},
	stringstyle=\color{orange},
}
\lstset{escapechar=@,style=customcpp}

%----------------------------------
\begin{document}

\maketitle

\begin{problem}
    这里是题目. 
\end{problem}

\begin{solution}
    这里是解答. 
\end{solution}

\begin{note}
    这里是注记. 
\end{note}

\begin{framed}
\begin{lstlisting}[language=C++]
//中文注释要用xlatex编译哦
    Here is the code.
    #include <stdio.h>

long Floor(int n);

int main()
{
    int num;
    scanf("%d", &num);
    getchar();
    printf("%ld",Floor(num));
    return 0;
}

long Floor(int n)
{
    if(n == 1)
        return n;
    else
        return n * Floor(n - 1);
}

long Floor(int n)
{
    if(n == 1)
        return n;
    else
        return n * Floor(n - 1);
}

int gcd(int a,int b) /*?*/
{
   int x;
   while(a % b != 0)
   {
       x = a % b;
       a = b;
       b = x;
    }
    return b;    
}

int ext(int *a, int *b) //dame??
{
    int c;
    c = *a;
    *a = *b;
    *b = c;
    return 0;
}
\end{lstlisting}
\end{framed}

\end{document}